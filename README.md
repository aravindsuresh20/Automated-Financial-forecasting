# Automated-Financial-forecasting

This project provides a web-based application for predicting the operational costs of startups in USD and INR. It utilizes a machine learning model (XGBoost Regressor) trained on historical startup funding data. The application first attempts to find an exact match for user-provided startup parameters (City, Industry Vertical, SubVertical) within the original dataset. If a direct match is found, it uses the actual historical cost. Otherwise, it leverages the trained model to predict the operational cost. All predictions are saved to an Excel file, which can be downloaded through the web interface.

## Features

* **Machine Learning Model**: Trains and uses an XGBoost Regressor model for robust cost prediction.
* **Categorical Feature Handling**: Employs Label Encoding to transform categorical features (Industry Vertical, SubVertical, City Location, Investment Type) for model training.
* **Data Normalization**: Includes helper functions to normalize input strings by converting to lowercase, removing hyphens, punctuation, and whitespace, ensuring consistency across dataset and user input.
* **Hybrid Prediction Logic**:
    * **Direct Match**: Prioritizes finding and using actual operational costs from the historical dataset if an exact match is found for the input parameters.
    * **Model Prediction**: Falls back to predicting costs using the trained XGBoost model if no direct match is found in the dataset.
* **Currency Conversion**: Converts predicted operational costs from USD to INR using a predefined conversion rate (83.2 USD to INR).
* **Prediction Persistence**: Saves all prediction results (including input parameters and predicted costs in USD and INR) to an Excel file (`prediction_results.xlsx`).
* **Web Interface (Flask)**:
    * Provides a simple homepage.
    * An interactive form for users to input startup details (City, Industry, SubVertical).
    * Displays prediction results on a dedicated results page.
    * Allows users to download the accumulated prediction results file directly from the web application.
* **Modular Design**: Separates core functionalities into `train_model.py` (model training), `utils.py` (utility functions like model loading and preprocessing), and `app.py` (Flask web application).

## Requirements

Ensure you have the following Python dependencies installed:

* Python 3.x
* Flask
* pandas
* xgboost
* scikit-learn (specifically `sklearn.model_selection` and `sklearn.preprocessing`)
* joblib
* openpyxl (for reading and writing Excel files)

## Installation

1.  **Set up Project Directory:**
    Organize your project files with the following structure:
    ```
    /startup-cost-prediction
    ├── app.py
    ├── train_model.py
    ├── utils.py
    ├── requirements.txt  # You will create this
    ├── dataset/
    │   └── startup_funding.xlsx # Your input data
    ├── model/
    │   ├── xgboost_model.pkl    # Generated after training
    │   └── label_encoders.pkl   # Generated after training
    └── output/
        └── prediction_results.xlsx # Generated by the app
    └── templates/
        ├── homepage.html
        ├── index.html
        └── result.html
    ```
    *Ensure `app.py`, `train_model.py`, and `utils.py` are in the project root. Create the `dataset`, `model`, `output`, and `templates` folders as shown.*

2.  **Set up a Virtual Environment (recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate # On Windows: venv\Scripts\activate
    ```

3.  **Create `requirements.txt`:**
    In your project root, create a file named `requirements.txt` and add the following content:
    ```
    Flask
    pandas
    xgboost
    scikit-learn
    joblib
    openpyxl
    ```

4.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

5.  **Prepare Input Data:**
    * Place your historical startup funding data Excel file (e.g., `startup_funding.xlsx`) inside the `dataset/` directory.
    * Ensure this file contains columns like 'Industry Vertical', 'SubVertical', 'City Location', 'InvestmentnType', and 'Amount in USD'.

6.  **Train the Machine Learning Model:**
    * This step generates the necessary model files for the Flask application.
    ```bash
    python train_model.py
    ```
    * Upon successful execution, `xgboost_model.pkl` and `label_encoders.pkl` will be created in the `model/` directory.

7.  **Run the Flask App:**
    ```bash
    python app.py
    ```

## Project Structure

/startup-cost-prediction │── app.py # Main Flask web application for handling requests and predictions │── train_model.py # Script for training and saving the XGBoost model and label encoders │── utils.py # Utility functions for loading model/encoders and preprocessing input data │── requirements.txt # Lists all project dependencies for easy installation │ ├── dataset/ # Directory for input data │ └── startup_funding.xlsx # The raw historical startup funding data │ ├── model/ # Directory for trained model assets │ ├── xgboost_model.pkl # The saved XGBoost regressor model │ └── label_encoders.pkl # Saved label encoders for categorical features │ ├── output/ # Directory for generated prediction results │ └── prediction_results.xlsx # Excel file containing all submitted predictions │ └── templates/ # HTML templates for the Flask web interface ├── homepage.html # The application's landing page ├── index.html # The form page for inputting prediction parameters └── result.html # The page displaying the prediction results

## Usage

1.  **Access the Application:**
    Open your web browser and navigate to `http://127.0.0.1:5000` (or the address displayed in your console after running `app.py`).

2.  **Navigate to the Prediction Form:**
    * From the homepage, you will find a link or button to proceed to the prediction form (`/predict`).

3.  **Enter Startup Details:**
    * On the prediction form, input the **City**, **Industry Vertical**, and **SubVertical** for which you want to predict the operational cost.
    * Submit the form.

4.  **View Prediction Results:**
    * The application will display the predicted operational cost in both USD and INR on the results page.

5.  **Download Prediction History:**
    * You can download the `prediction_results.xlsx` file, which contains a record of all predictions made through the application, by navigating to `http://127.0.0.1:5000/download_output_file`.
